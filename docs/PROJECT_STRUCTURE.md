# Project Structure

- app/
  - (app)/
    - layout.tsx (protected app shell + active finance entity server action wiring)
    - layout.module.scss
    - app-sidebar.tsx (route nav + active finance entity selector)
    - dashboard/
      - page.tsx (main transaction-first dashboard + quick posting)
    - transactions/
      - page.tsx (transactions page shell + server actions + indexed filters + server pagination)
      - add-transaction-modal.tsx (transaction create modal trigger/form with icon action)
      - transactions-table.tsx (transaction table + edit modal + icon edit/delete actions)
    - income/
      - page.tsx (income stream management page shell + server actions)
      - add-income-stream-modal.tsx (income stream create modal trigger/form with icon action)
      - income-stream-table.tsx (income stream table + edit modal + icon edit/delete actions)
    - investment/
      - page.tsx (investment management page shell + server actions)
      - add-investment-modal.tsx (investment create modal trigger/form with icon action)
      - investment-table.tsx (investment table + edit modal + icon edit/delete actions)
    - budget/
      - page.tsx (budget page shell + server actions for create/allocate/edit/delete)
      - add-budget-envelope-modal.tsx (budget envelope create modal trigger/form with icon action)
      - allocate-budget-modal.tsx (budget allocation modal trigger/form with icon action)
      - budget-envelope-table.tsx (budget envelope table + edit modal + icon edit/delete actions)
    - loan/
      - page.tsx (loan registry + modal actions for repayment/create)
      - loan-transaction-modal.tsx (loan transaction modal form trigger + submit flow)
      - add-loan-record-modal.tsx (loan record create modal trigger/form)
      - loan-record-table.tsx (loan table UI + edit modal + icon delete confirmation for both sections)
    - credit/
      - page.tsx (credit card account management page shell + server actions)
      - add-credit-account-modal.tsx (credit account create modal trigger/form with icon action)
      - credit-account-table.tsx (credit account table + edit modal + icon edit/archive actions)
    - entity/
      - page.tsx (finance entity management page shell + server actions)
      - add-entity-modal.tsx (icon-triggered entity create modal)
      - entity-table.tsx (entity table with icon edit/delete actions + edit modal)
    - wallet/
      - page.tsx (wallet account management page shell + server actions)
      - add-wallet-account-modal.tsx (wallet account create modal trigger/form)
      - wallet-account-grid.tsx (wallet account grouped card UI + edit modal + icon actions)
      - page.module.scss (wallet route style module shared by wallet components)
    - monthly-overview/
      - page.tsx (historical wallet overview table/chart)
      - chart-modal.tsx
      - entry-table.tsx
  - (auth)/
    - layout.tsx
    - layout.module.scss
    - login/page.tsx
    - signup/page.tsx
  - api/
    - auth/
      - login/route.ts
      - logout/route.ts
      - signup/route.ts
  - components/
    - action-icon-button.tsx
    - confirmation-modal.tsx
    - confirm-submit-button.tsx
    - confirm-submit-icon-button.tsx
    - toast-provider.tsx
    - finance/
      - metric-card.tsx
      - toggleable-metric-card-grid.tsx (shared metric-card grid with global hide/show-all toggle + local storage persistence)
      - transaction-kind-badge.tsx
      - transaction-form.tsx
  - styles/
    - _theme-tokens.scss
    - _base.scss
    - _components.scss
  - globals.scss
  - layout.tsx
  - page.tsx
  - theme-toggle.module.scss
  - theme-toggle.tsx
- lib/
  - auth.ts
  - prisma.ts
  - server-session.ts
  - finance/
    - bootstrap.ts
    - coins-ph.ts
    - constants.ts
    - credit-payment-envelope.ts (per-card credit payment reserve envelope resolver/ensurer)
    - context.ts
    - entity-context.ts (active entity resolution, ownership checks, entity cookie, delete guardrails)
    - entity-scoped-records.ts (canonical entity-owned CreditAccount/Investment access helpers)
    - entity-scoped-records.test.ts
    - entity-scope-verification.ts (shared verifier rules for Sprint 2 migration checks)
    - entity-scope-verification.test.ts
    - form-parsers.ts
    - money.ts
    - posting-engine.ts
    - posting-engine.test.ts
    - queries.ts (entity-scoped KPI grouped aggregates + structured diagnostics logs)
    - queries.test.ts
    - transaction-orchestration.ts
    - types.ts
- prisma/
  - schema.prisma
  - verify-sprint2-entity-scope.ts (read-only manual verifier for Sprint 2 entity-scope migration)
  - migrations/
    - 20260226141602_sprint1_posting_engine_hardening/migration.sql
    - 20260226150750_sprint2_entity_scope_refactor/migration.sql
    - 20260226152651_sprint3_debt_aware_credit_card_logic/migration.sql
    - 20260226174508_sprint4/migration.sql
    - 20260226181053_sprint5_performance_reporting_readiness/migration.sql
    - 20260227040000_remove-import-staging-feature/migration.sql
- docs/
  - POSTING_ENGINE_MATRIX.md (posting validation matrix + reversal/debt-aware credit reserve contract)
- public/
- vitest.config.ts

Notes:

- Protected pages are under `app/(app)`.
- New finance domain models are in Prisma (`WalletAccount`, `CreditAccount`, `Investment`, `IncomeStream`, `BudgetEnvelope`, `LoanRecord`, `FinanceTransaction`).
- Multi-entity isolation uses `FinanceEntity` as the primary boundary for all entity-scoped financial models.
- Legacy model (`MonthlyOverviewEntry`) remains user-scoped for migration compatibility.
- Sprint 5 adds entity/reporting-focused index coverage and paginated ledger browsing.
